{% comment %}
  VersaCommerce Cart Page Section
{% endcomment %}

<section class="py-8 bg-light-bg ">
  <div class="container">
    {% if cart.item_count > 0 %}
      <!-- Cart Manager Data Script -->
      <script type="application/json" id="cart-manager-data">
        {
          "initialItems": [
            {% for item in cart.items %}
              {
                "id": {{ item.key | json }},
                "title": {{ item.product.title | json }},
                "variant": {% if item.variant.title != 'Default Title' %}{{ item.variant.title | json }}{% else %}""{% endif %},
                "price": {{ item.price | money | json }},
                "priceRaw": {{ item.price }},
                "quantity": {{ item.quantity }},
                "linePrice": {{ item.line_price | money | json }},
                "linePriceRaw": {{ item.line_price }},
                {% if item.image %}"imageUrl": {{ item.image | image_url: width: 200, height: 200 | json }},{% endif %}
                "productUrl": {{ item.url | json }},
                "removeUrl": {{ item.url_to_remove | json }}
              }{% unless forloop.last %},{% endunless %}
            {% endfor %}
          ],
          "initialSubtotal": {{ cart.total_price | money | json }},
          "initialTotal": {{ cart.total_price | money | json }},
          "initialItemCount": {{ cart.item_count }},
          "freeShippingThreshold": 50,
          "currentSubtotal": {{ cart.total_price | divided_by: 100.0 }},
          "currency": {
            "code": {{ cart.currency.iso_code | json }},
            "symbol": {{ cart.currency.symbol | json }},
            "name": {{ cart.currency.name | json }}
          },
          "shopCurrency": {
            "code": {{ shop.currency | json }},
            "format": {{ shop.money_format | json }}
          }
        }
      </script>

      <!-- Make currency data available globally -->
      <script>
        window.shopCurrency = {
          code: {{ shop.currency | json }},
          format: {{ shop.money_format | json }}
        };
        window.cartCurrency = {
          code: {{ cart.currency.iso_code | json }},
          symbol: {{ cart.currency.symbol | json }},
          name: {{ cart.currency.name | json }}
        };
      </script>

      <div
        data-react-component="VersaCartManager"
        data-props-script="cart-manager-data"
      ></div>

    {% else %}
      <!-- Empty Cart State -->
      <div
        data-react-component="VersaEmptyCart"
      ></div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Cart",
  "settings": []
}
{% endschema %}
