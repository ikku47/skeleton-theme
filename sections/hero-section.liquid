{% comment %}
  Expressive Hero Section with React component integration
  Features: Product showcase, testimonials, customer avatars, dynamic layout
{% endcomment %}

{% liquid
  assign title = section.settings.title | default: 'Elevate Your Style With Bold Fashion'
  assign primary_button_text = section.settings.primary_button_text | default: 'Explore Collections'
  assign primary_button_url = section.settings.primary_button_url | default: '/collections/all'
  assign testimonial_text = section.settings.testimonial_text | default: 'TrendZone styles are fresh, bold and exactly what I needed to upgrade my wardrobe. Love the quality and vibe!'
  assign testimonial_author = section.settings.testimonial_author | default: 'Ruby Chen'
  assign show_customers = section.settings.show_customers | default: true
  assign featured_collection = section.settings.featured_collection

  # Get featured products from collection or all products
  if featured_collection != blank
    assign all_products = collections[featured_collection].products
  else
    assign all_products = collections.all.products
  endif
%}

{% capture hero_props %}
{
  "title": "{{ title | escape }}",
  "primaryButtonText": "{{ primary_button_text | escape }}",
  "primaryButtonUrl": "{{ primary_button_url }}",
  "testimonialText": "{{ testimonial_text | escape }}",
  "testimonialAuthor": "{{ testimonial_author | escape }}",
  "showCustomers": {{ show_customers }},
  "products": [
    {% assign product_count = 0 %}
    {% for product in all_products %}
      {% if product_count < 6 %}
        {% assign product_count = product_count | plus: 1 %}
        {
          "id": "{{ product.id }}",
          "title": "{{ product.title | escape }}",
          "image": "{{ product.featured_image | image_url: width: 400, height: 500 }}",
          "url": "{{ product.url }}",
          "price": "{{ product.price | money }}",
          "color": "{% cycle 'bg-orange-400', 'bg-emerald-500', 'bg-yellow-400', 'bg-sky-400', 'bg-stone-200', 'bg-emerald-600' %}"
        }{% unless product_count == 6 or forloop.last %},{% endunless %}
      {% endif %}
    {% endfor %}
  ],
  "customerAvatars": [
    {% for block in section.blocks %}
      {% if block.type == 'customer_avatar' and block.settings.avatar %}
        "{{ block.settings.avatar | image_url: width: 80, height: 80 }}"{% unless forloop.last %},{% endunless %}
      {% endif %}
    {% endfor %}
  ]
}
{% endcapture %}

{% render 'react-component', component: 'HeroSection', props: hero_props %}

{% schema %}
{
  "name": "Expressive Hero Section",
  "tag": "section",
  "class": "hero-section",
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Main Title",
      "default": "Elevate Your Style With Bold Fashion"
    },
    {
      "type": "text",
      "id": "primary_button_text",
      "label": "Button Text",
      "default": "Explore Collections"
    },
    {
      "type": "url",
      "id": "primary_button_url",
      "label": "Button URL",
      "default": "/collections/all"
    },
    {
      "type": "header",
      "content": "Products"
    },
    {
      "type": "collection",
      "id": "featured_collection",
      "label": "Featured Collection",
      "info": "Select a collection to showcase products. If none selected, will show latest products."
    },
    {
      "type": "header",
      "content": "Testimonial"
    },
    {
      "type": "textarea",
      "id": "testimonial_text",
      "label": "Testimonial Text",
      "default": "TrendZone styles are fresh, bold and exactly what I needed to upgrade my wardrobe. Love the quality and vibe!"
    },
    {
      "type": "text",
      "id": "testimonial_author",
      "label": "Testimonial Author",
      "default": "Ruby Chen"
    },
    {
      "type": "header",
      "content": "Social Proof"
    },
    {
      "type": "checkbox",
      "id": "show_customers",
      "label": "Show Customer Avatars",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "customer_avatar",
      "name": "Customer Avatar",
      "settings": [
        {
          "type": "image_picker",
          "id": "avatar",
          "label": "Customer Avatar"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Expressive Hero Section",
      "blocks": [
        {
          "type": "customer_avatar"
        },
        {
          "type": "customer_avatar"
        },
        {
          "type": "customer_avatar"
        }
      ]
    }
  ]
}
{% endschema %}
